# The following is an easter egg. As far as i know only p2ecm(num) 
# can factor this number. Enjoy the message and ponder what it means. The security of
# using numbers like this are lacking to say the least, but it least we can factor it
# and enjoy an easter egg. It will take less than 2 minutes to factor, but only nano
# seconds once you find it's secret message about it's security.
# Run on the cmd line by: python3 secretmessage.py
# Try factoring this (N) number at https://www.alpertron.com.ar/ECM.HTM
# the same engine that we use in sfactorint's p2ecm

from sfactorint import p2ecm, inv_mod

e=65537

N=59893611576109667745591501557768518524757716237069644258704861576242171401997307866879683323070966660204404152184193810674102156666657370390138530234649080171855713105130196952359459038561431989638152182117995184731466993342885255931809452953066180362252477157103441113001094605527343278901414111254455206926645055846351057616910772608479787438025683542018487410813110401975388130870408240200388515540931241753871580499716942033016530617650880195162728159984102206575546189706186608379472073452619741393751338631

cipher=23964584030959930392314284750363080541725642992637408140059062141527128781438225482878278170441697357294275589988293913679431182349210949081097865329330212907904153415948824701848110608982828790871810652129880017576406831607437223361817316849577589733297629949897144753980638322160262839915077795036344648836202845274426912552420328057508675102211527394950764947606552787354412926169490022100097948133727448728452807578199966030505263478188105153119517001834573970585404456563257550338858339162630519275661840016

print()
print(f"Attempting to factor {N}")
print()

p,q = p2ecm(N)

PHI=(p-1)*(q-1)

d=inv_mod(e,PHI)

message=pow(cipher,d,N)

print(bytes.fromhex(hex(int(str((abs(message))),10))[2:]))

print()
print()
